<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NEXUS-TOOL | Network Intelligence V2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Nexus-Tool V2 — Advanced Network Intelligence & OSINT Suite" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* ═══════════════════════════════════════════════════════════════════════
       NEXUS-TOOL V2 — NETWORK INTELLIGENCE INTERFACE
       ═══════════════════════════════════════════════════════════════════════ */

    :root {
      --bg:        #030508;
      --cyan:      #00e5ff;
      --cyan-dim:  rgba(0,229,255,.12);
      --pink:      #ff2dff;
      --green:     #00ff6a;
      --amber:     #ffc400;
      --red:       #ff3b3b;
      --text:      #e0eeff;
      --dim:       rgba(210,232,250,.7);
      --border:    rgba(0,229,255,.1);
      --surface:   rgba(0,12,24,.55);
      --surface-2: rgba(0,18,36,.7);
      --glow-cyan: 0 0 20px rgba(0,229,255,.15);
      --glow-pink: 0 0 20px rgba(255,45,255,.15);
      --f-hud:     'Orbitron', sans-serif;
      --f-mono:    'Share Tech Mono', monospace;
      --f-body:    'Rajdhani', sans-serif;
      --ease:      cubic-bezier(.22,1,.36,1);
      --radius:    2px;
    }
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

    html { scroll-behavior: smooth; }

    body {
      background:var(--bg);
      color:var(--text);
      font-family:var(--f-mono);
      min-height:100vh;
      overflow-x:hidden;
      -webkit-font-smoothing:antialiased;
    }

    /* ═══ FIXED OVERLAYS ══════════════════════════════════════════════════ */
    .scanlines {
      position:fixed; inset:0; z-index:1; pointer-events:none;
      background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.04) 2px,rgba(0,0,0,.04) 4px);
    }
    .vignette {
      position:fixed; inset:0; z-index:1; pointer-events:none;
      background:radial-gradient(ellipse at center,transparent 40%,rgba(0,0,0,.75) 100%);
    }
    #bg-canvas { position:fixed; inset:0; z-index:0; pointer-events:none; }

    /* ═══ BOOT SEQUENCE ═══════════════════════════════════════════════════ */
    #boot {
      position:fixed; inset:0; z-index:200;
      display:flex; align-items:center; justify-content:center;
      background:var(--bg);
      transition:opacity .8s var(--ease);
    }
    #boot.out { opacity:0; pointer-events:none; }

    #term {
      position:relative;
      width:min(600px,90vw);
      background:rgba(0,6,14,.96);
      border:1px solid rgba(0,229,255,.35);
      padding:28px 26px 24px;
      font-size:clamp(.7rem,1.6vw,.82rem);
      box-shadow: var(--glow-cyan), inset 0 0 40px rgba(0,0,0,.5);
      border-radius:var(--radius);
    }
    #term::before {
      content:'NEXUS-TOOL_BOOT_V2.0';
      position:absolute; top:-10px; left:18px;
      font-family:var(--f-hud); font-size:.52rem; letter-spacing:4px;
      color:var(--cyan); background:var(--bg); padding:0 10px;
    }
    #term::after {
      content:'';
      position:absolute; bottom:-1px; right:-1px;
      width:14px; height:14px;
      border-bottom:2px solid var(--cyan); border-right:2px solid var(--cyan);
    }
    #boot-lines { min-height:240px; overflow:hidden; }
    .bl { line-height:1.95; white-space:pre; animation:blin .25s var(--ease) both; }
    @keyframes blin { from{opacity:0;transform:translateX(-8px)} to{opacity:1;transform:none} }
    .bt  { font-family:var(--f-hud); font-size:clamp(1rem,3vw,1.35rem); color:var(--cyan); letter-spacing:8px; text-shadow:0 0 30px var(--cyan), 0 0 60px rgba(0,229,255,.3); }
    .bs  { color:var(--pink); font-size:.68rem; letter-spacing:4px; }
    .bd  { color:rgba(0,229,255,.55); }
    .bok { color:var(--green); }
    .bw  { color:var(--amber); }
    .br  { color:var(--cyan); }
    .ba  { color:var(--pink); }
    #cur { display:inline-block; width:8px; height:14px; background:var(--cyan); margin-left:2px; vertical-align:middle; animation:cur .7s step-end infinite; box-shadow:0 0 8px var(--cyan); }
    @keyframes cur { 0%,100%{opacity:1} 50%{opacity:0} }
    .bbar { margin-top:16px; height:3px; background:rgba(0,229,255,.08); overflow:hidden; border-radius:2px; }
    #bprog { height:100%; width:0%; background:linear-gradient(90deg,var(--cyan),var(--pink)); box-shadow:0 0 12px var(--cyan); transition:width .35s var(--ease); border-radius:2px; }

    /* ═══ INTRO / ABOUT SECTION ═══════════════════════════════════════════ */
    #intro {
      position:fixed; inset:0; z-index:150;
      display:none; align-items:center; justify-content:center;
      background:var(--bg);
      opacity:0;
      transition:opacity .6s var(--ease);
    }
    #intro.visible { display:flex; opacity:1; }
    #intro.out { opacity:0; pointer-events:none; }

    .intro-container {
      width:min(820px,92vw);
      max-height:100vh;
      overflow-y:auto;
      display:flex; flex-direction:column; align-items:center;
      gap:12px; padding:16px 20px;
      text-align:center;
    }

    .intro-hex {
      width:70px; height:70px;
      position:relative;
      margin-bottom:2px;
      animation:introSpin 20s linear infinite;
    }
    @keyframes introSpin { from{transform:rotate(0)} to{transform:rotate(360deg)} }
    .intro-hex svg { width:100%; height:100%; }

    .intro-title {
      font-family:var(--f-hud);
      font-size:clamp(1.6rem,6vw,3rem);
      font-weight:900;
      letter-spacing:.18em;
      line-height:1.1;
      background:linear-gradient(135deg,var(--cyan) 0%,#fff 40%,var(--pink) 100%);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
      text-shadow:none;
      animation:introTitle 1s var(--ease) both;
    }
    @keyframes introTitle { from{opacity:0;transform:translateY(20px) scale(.95)} to{opacity:1;transform:none} }

    .intro-version {
      font-family:var(--f-hud);
      font-size:clamp(.65rem,2vw,.85rem);
      letter-spacing:6px;
      color:var(--pink);
      padding:4px 18px;
      border:1px solid rgba(255,45,255,.3);
      animation:introVer 1s .3s var(--ease) both;
    }
    @keyframes introVer { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:none} }

    .intro-desc {
      font-family:var(--f-body);
      font-size:clamp(.85rem,2.2vw,1.05rem);
      font-weight:400;
      line-height:1.6;
      color:rgba(210,232,250,.92);
      max-width:560px;
      animation:introDesc 1s .5s var(--ease) both;
    }
    @keyframes introDesc { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:none} }

    .intro-features {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
      gap:10px;
      width:100%;
      max-width:600px;
      animation:introFeat 1s .7s var(--ease) both;
    }
    @keyframes introFeat { from{opacity:0;transform:translateY(15px)} to{opacity:1;transform:none} }

    .intro-feat {
      padding:12px 10px;
      background:var(--surface);
      border:1px solid var(--border);
      border-top:2px solid var(--cyan);
      text-align:center;
      transition:border-color .3s, transform .3s;
    }
    .intro-feat:hover { border-color:rgba(0,229,255,.35); transform:translateY(-2px); }
    .intro-feat-icon {
      font-family:var(--f-hud);
      font-size:1rem;
      color:var(--cyan);
      margin-bottom:4px;
      text-shadow:0 0 15px rgba(0,229,255,.3);
    }
    .intro-feat-title {
      font-family:var(--f-hud);
      font-size:.6rem;
      letter-spacing:2px;
      color:var(--text);
      margin-bottom:3px;
    }
    .intro-feat-desc {
      font-family:var(--f-body);
      font-size:.78rem;
      color:rgba(210,232,250,.85);
      line-height:1.4;
    }

    /* ── Countdown Ring ── */
    .intro-countdown {
      position:relative;
      width:70px; height:70px;
      margin-top:4px;
      animation:introBtn 1s .85s var(--ease) both;
    }
    .countdown-ring { width:100%; height:100%; transform:rotate(-90deg); }
    .countdown-track {
      fill:none; stroke:rgba(0,229,255,.08); stroke-width:3;
    }
    .countdown-fill {
      fill:none; stroke:var(--cyan); stroke-width:3;
      stroke-dasharray:276.46; stroke-dashoffset:0;
      stroke-linecap:round;
      transition:stroke-dashoffset 1s linear;
      filter:drop-shadow(0 0 6px rgba(0,229,255,.4));
    }
    .countdown-num {
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      font-family:var(--f-hud); font-size:1.3rem; font-weight:700;
      color:var(--cyan); text-shadow:0 0 15px rgba(0,229,255,.4);
      letter-spacing:2px;
    }
    .intro-auto {
      font-family:var(--f-body); font-size:.72rem;
      color:var(--dim); letter-spacing:2px;
      animation:introBtn 1s .9s var(--ease) both;
    }
    .intro-auto kbd {
      background:rgba(0,229,255,.06); border:1px solid var(--border);
      padding:1px 6px; color:var(--cyan); font-size:.6rem; font-family:var(--f-mono);
    }
    .intro-auto span { color:var(--cyan); font-weight:700; }

    .intro-enter {
      margin-top:4px;
      padding:12px 38px;
      background:transparent;
      border:1px solid var(--cyan);
      color:var(--cyan);
      font-family:var(--f-hud);
      font-size:.78rem;
      letter-spacing:4px;
      cursor:pointer;
      transition:all .3s var(--ease);
      animation:introBtn 1s .95s var(--ease) both;
      position:relative;
      overflow:hidden;
    }
    @keyframes introBtn { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:none} }
    .intro-enter::before {
      content:'';
      position:absolute; inset:0;
      background:linear-gradient(90deg,transparent,rgba(0,229,255,.1),transparent);
      transform:translateX(-100%);
      transition:transform .5s var(--ease);
    }
    .intro-enter:hover::before { transform:translateX(100%); }
    .intro-enter:hover {
      background:rgba(0,229,255,.08);
      box-shadow:0 0 30px rgba(0,229,255,.2), inset 0 0 30px rgba(0,229,255,.05);
      transform:translateY(-1px);
    }

    /* ═══ MAIN APP ════════════════════════════════════════════════════════ */
    #app {
      position:relative; z-index:10;
      display:none; flex-direction:column; align-items:center;
      min-height:100vh; padding:16px 14px 36px;
      opacity:0; transition:opacity .6s var(--ease);
    }
    #app.on { opacity:1; }
    .shell { width:100%; max-width:1120px; display:flex; flex-direction:column; gap:12px; }

    /* ═══ HEADER ══════════════════════════════════════════════════════════ */
    .hdr {
      display:flex; justify-content:space-between; align-items:flex-end;
      padding:18px 22px; gap:16px; flex-wrap:wrap;
      background:var(--surface); border:1px solid var(--border); border-top:2px solid var(--cyan);
      animation:fadeSlide .6s var(--ease) both;
    }
    @keyframes fadeSlide { from{opacity:0;transform:translateY(-10px)} to{opacity:1;transform:none} }

    .brand-wrap { display:flex; align-items:baseline; gap:12px; flex-wrap:wrap; }
    .brand {
      font-family:var(--f-hud); font-size:clamp(1.6rem,5vw,2.5rem); font-weight:900; letter-spacing:.18em;
      background:linear-gradient(135deg,var(--cyan),#fff 50%,var(--cyan));
      -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
      animation:glitch 12s infinite;
    }
    @keyframes glitch {
      0%,84%,100%{filter:none;transform:none}
      86%{filter:drop-shadow(-2px 0 var(--pink)) drop-shadow(2px 0 var(--cyan));transform:translateX(-1px)}
      88%{filter:none;transform:none}
      90%{filter:drop-shadow(2px 0 var(--pink));transform:translateX(2px)}
      92%{filter:none;transform:none}
    }
    .brand-v {
      font-family:var(--f-hud);
      font-size:.6rem;
      letter-spacing:3px;
      color:var(--bg);
      background:var(--pink);
      padding:2px 8px;
      line-height:1.5;
    }
    .brand-sub { font-family:var(--f-body); font-size:.7rem; color:rgba(210,232,250,.75); letter-spacing:3px; margin-top:4px; font-weight:400; }
    .hdr-right { text-align:right; display:flex; flex-direction:column; gap:5px; align-items:flex-end; }
    .h-clock { font-family:var(--f-hud); font-size:1.05rem; color:var(--cyan); text-shadow:0 0 10px rgba(0,229,255,.3); }
    .h-tag { font-size:.58rem; letter-spacing:2px; display:flex; align-items:center; gap:6px; }
    .dot { width:6px; height:6px; border-radius:50%; background:var(--green); box-shadow:0 0 8px var(--green); animation:pulse 1.8s ease-in-out infinite; }
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.25} }
    #cip { color:var(--amber); }

    /* ═══ SEARCH ══════════════════════════════════════════════════════════ */
    .search {
      background:var(--surface); border:1px solid var(--border); padding:18px 20px;
      animation:fadeSlide .6s .1s var(--ease) both;
    }
    .slabel { font-size:.58rem; letter-spacing:3px; color:var(--dim); margin-bottom:10px; font-family:var(--f-hud); }
    .srow { display:flex; gap:10px; align-items:stretch; }
    .iwrap { position:relative; flex:1; }
    .ipfx { position:absolute; left:14px; top:50%; transform:translateY(-50%); color:var(--cyan); font-size:.85rem; pointer-events:none; opacity:.85; }
    #qi {
      width:100%; background:rgba(0,0,0,.5); border:1px solid rgba(0,229,255,.3);
      color:var(--cyan); font-family:var(--f-mono); font-size:1rem;
      padding:14px 14px 14px 32px; outline:none; transition:all .25s var(--ease);
      border-radius:var(--radius);
    }
    @media(max-width:480px){ #qi{font-size:16px; padding:12px 12px 12px 30px;} }
    #qi::placeholder { color:rgba(0,229,255,.42); }
    #qi:focus { background:rgba(0,229,255,.03); border-color:var(--cyan); box-shadow:0 0 0 1px rgba(0,229,255,.3),0 0 20px rgba(0,229,255,.08); }
    #qbtn {
      padding:14px 26px; background:rgba(255,45,255,.05); border:1px solid rgba(255,45,255,.5);
      color:var(--pink); font-family:var(--f-hud); font-size:.72rem; letter-spacing:3px;
      cursor:pointer; transition:all .3s var(--ease); white-space:nowrap; min-height:48px;
      border-radius:var(--radius); position:relative; overflow:hidden;
    }
    #qbtn::before {
      content:''; position:absolute; inset:0;
      background:linear-gradient(90deg,transparent,rgba(255,45,255,.08),transparent);
      transform:translateX(-100%); transition:transform .4s;
    }
    #qbtn:hover:not(:disabled)::before { transform:translateX(100%); }
    #qbtn:hover:not(:disabled){ background:var(--pink); color:#000; box-shadow:0 0 28px rgba(255,45,255,.4); }
    #qbtn:disabled { opacity:.25; cursor:not-allowed; }
    .shint { margin-top:8px; font-size:.58rem; color:var(--dim); font-family:var(--f-body); }
    .shint kbd { background:rgba(0,229,255,.06); border:1px solid var(--border); padding:2px 6px; color:var(--cyan); font-size:.58rem; font-family:var(--f-mono); }
    .sbar { height:3px; background:rgba(0,229,255,.06); overflow:hidden; margin-top:10px; display:none; border-radius:2px; }
    .sbar.on { display:block; }
    .sfill { height:100%; width:35%; background:linear-gradient(90deg,transparent,var(--cyan),var(--pink),transparent); animation:ss 1.4s ease-in-out infinite; }
    @keyframes ss { 0%{transform:translateX(-200%)} 100%{transform:translateX(400%)} }

    /* ═══ HISTORY ═════════════════════════════════════════════════════════ */
    .hbar {
      display:flex; align-items:center; gap:8px; flex-wrap:wrap;
      padding:10px 14px; background:rgba(0,6,14,.65); border:1px solid var(--border); min-height:44px;
      animation:fadeSlide .6s .15s var(--ease) both;
    }
    .hlbl { font-size:.55rem; letter-spacing:3px; color:var(--dim); flex-shrink:0; font-family:var(--f-hud); }
    .hchip {
      padding:5px 12px; background:transparent; border:1px solid var(--border);
      color:var(--cyan); font-family:var(--f-mono); font-size:.7rem;
      cursor:pointer; transition:all .2s var(--ease); min-height:32px;
      border-radius:var(--radius);
    }
    .hchip:hover { border-color:var(--cyan); background:rgba(0,229,255,.06); box-shadow:var(--glow-cyan); }
    .hclr {
      padding:4px 11px; background:transparent; border:1px solid rgba(255,59,59,.25);
      color:rgba(255,59,59,.8); font-family:var(--f-mono); font-size:.58rem;
      cursor:pointer; transition:all .2s; margin-left:auto; min-height:28px;
      border-radius:var(--radius);
    }
    .hclr:hover { border-color:var(--red); color:var(--red); }

    /* ═══ RESULTS GRID ═══════════════════════════════════════════════════ */
    .grid {
      display:grid;
      grid-template-columns:1fr 1fr;
      grid-template-areas:"core geo" "ports ports" "dns http";
      gap:12px;
      animation:fadeSlide .6s .2s var(--ease) both;
    }
    @media(max-width:768px){
      .grid {
        grid-template-columns:1fr;
        grid-template-areas:"core""geo""ports""dns""http";
      }
    }
    .a-core  { grid-area:core; }
    .a-geo   { grid-area:geo; }
    .a-ports { grid-area:ports; }
    .a-dns   { grid-area:dns; }
    .a-http  { grid-area:http; }

    /* ═══ PANEL ══════════════════════════════════════════════════════════ */
    .panel {
      background:var(--surface-2); border:1px solid var(--border);
      display:flex; flex-direction:column; position:relative;
      transition:border-color .3s var(--ease), box-shadow .3s var(--ease);
      border-radius:var(--radius);
    }
    .panel:hover { border-color:rgba(0,229,255,.22); box-shadow:var(--glow-cyan); }
    .panel::before {
      content:''; position:absolute; top:-1px; left:-1px;
      width:12px; height:12px; border-top:1px solid var(--cyan); border-left:1px solid var(--cyan);
    }
    .panel::after {
      content:''; position:absolute; bottom:-1px; right:-1px;
      width:12px; height:12px; border-bottom:1px solid var(--cyan); border-right:1px solid var(--cyan);
    }
    .ph {
      display:flex; justify-content:space-between; align-items:center;
      padding:10px 16px; border-bottom:1px solid var(--border); background:rgba(0,229,255,.015);
      flex-shrink:0;
    }
    .pt { font-family:var(--f-hud); font-size:.62rem; letter-spacing:2.5px; color:var(--cyan); }
    .pbadge { font-size:.54rem; padding:2px 8px; border:1px solid var(--amber); color:var(--amber); letter-spacing:1.5px; display:none; font-family:var(--f-hud); }
    .pmeta  { font-size:.56rem; color:var(--dim); letter-spacing:1.5px; font-family:var(--f-hud); }
    .pmeta.open { color:var(--green); }
    .scanning .ph { animation:spulse 1.3s ease-in-out infinite; }
    @keyframes spulse { 0%,100%{border-bottom-color:var(--border)} 50%{border-bottom-color:rgba(0,229,255,.45)} }
    .pb { padding:12px 16px; flex:1; display:flex; flex-direction:column; }
    .idle { display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px; flex:1; min-height:80px; color:var(--dim); }
    .idle-icon { font-family:var(--f-hud); font-size:.65rem; letter-spacing:3px; }
    .idle-txt  { font-size:.62rem; letter-spacing:1.5px; font-family:var(--f-body); }

    /* ═══ DATA ROWS ══════════════════════════════════════════════════════ */
    .dr {
      display:grid; grid-template-columns:130px 1fr; align-items:baseline; gap:12px;
      padding:6px 0; border-bottom:1px solid rgba(255,255,255,.06);
      opacity:0; transform:translateX(-8px); transition:opacity .4s var(--ease),transform .4s var(--ease);
    }
    .dr:last-child { border-bottom:none; }
    .dr.on { opacity:1; transform:none; }
    .dl { font-size:.6rem; letter-spacing:.5px; color:var(--dim); text-transform:uppercase; white-space:nowrap; font-family:var(--f-hud); }
    .dv { font-size:.78rem; color:var(--cyan); word-break:break-all; }
    .dv.g { color:var(--green); }
    .dv.a { color:var(--amber); }
    .dv.r { color:var(--red); }
    .dv.d { color:rgba(210,232,250,.7); }
    .map  { cursor:pointer; border-bottom:1px dashed rgba(0,229,255,.5); transition:color .2s; }
    .map:hover { color:#fff; }
    .txt-r { cursor:help; border-bottom:1px dashed rgba(0,229,255,.45); transition:color .2s; }
    .txt-r:hover { color:#fff; }

    @media(max-width:500px){
      .dr { grid-template-columns:1fr; gap:3px; }
    }

    /* ═══ PORT BADGES ════════════════════════════════════════════════════ */
    .pgrid { display:flex; flex-wrap:wrap; gap:8px; padding:4px 0; }
    .pbadge-port {
      display:flex; flex-direction:column; align-items:center;
      padding:6px 12px; min-width:56px; gap:3px;
      background:rgba(0,255,106,.05); border:1px solid rgba(0,255,106,.3);
      transition:all .25s var(--ease);
      border-radius:var(--radius);
    }
    .pbadge-port:hover { background:rgba(0,255,106,.12); box-shadow:0 0 14px rgba(0,255,106,.2); transform:translateY(-2px); }
    .pnum { font-family:var(--f-hud); font-size:.8rem; font-weight:700; color:var(--green); }
    .psvc { font-size:.54rem; color:rgba(0,255,106,.85); text-transform:uppercase; letter-spacing:.5px; font-family:var(--f-hud); }
    .closed-list { font-size:.65rem; color:var(--dim); line-height:1.85; padding-top:5px; word-break:break-all; }

    /* ═══ SECURITY BADGES ════════════════════════════════════════════════ */
    .secs { display:flex; flex-wrap:wrap; gap:6px; }
    .sbadge { padding:3px 8px; font-size:.58rem; border:1px solid; letter-spacing:.5px; white-space:nowrap; font-family:var(--f-hud); border-radius:var(--radius); }
    .sok  { border-color:var(--green); color:var(--green); background:rgba(0,255,106,.04); }
    .snok { border-color:var(--red);   color:var(--red);   background:rgba(255,59,59,.04); }

    /* ═══ ACTION PANEL ═══════════════════════════════════════════════════ */
    .action-panel {
      background:var(--surface-2);
      border:1px solid var(--border);
      border-radius:var(--radius);
      position:relative;
      animation:fadeSlide .6s .25s var(--ease) both;
      overflow:hidden;
    }
    .action-panel::before {
      content:''; position:absolute; top:-1px; left:-1px;
      width:12px; height:12px; border-top:1px solid var(--cyan); border-left:1px solid var(--cyan);
    }
    .action-panel::after {
      content:''; position:absolute; bottom:-1px; right:-1px;
      width:12px; height:12px; border-bottom:1px solid var(--cyan); border-right:1px solid var(--cyan);
    }
    .action-panel-header {
      display:flex; justify-content:space-between; align-items:center;
      padding:10px 16px; border-bottom:1px solid var(--border); background:rgba(0,229,255,.015);
    }
    .action-panel-title {
      font-family:var(--f-hud); font-size:.62rem; letter-spacing:2.5px; color:var(--cyan);
    }
    .action-panel-status {
      font-family:var(--f-hud); font-size:.52rem; letter-spacing:2px;
      padding:3px 10px; border:1px solid var(--border); color:var(--dim);
      transition:all .3s var(--ease);
    }
    .action-panel-status.active {
      border-color:var(--green); color:var(--green);
    }
    .action-panel-body {
      display:flex; align-items:stretch;
      padding:0;
    }
    .action-divider {
      width:1px; background:var(--border); flex-shrink:0;
    }
    .action-card {
      flex:1; display:flex; align-items:center; gap:14px;
      padding:16px 20px;
      background:transparent; border:none;
      cursor:pointer; transition:all .3s var(--ease);
      position:relative; overflow:hidden;
      text-align:left;
    }
    .action-card::before {
      content:''; position:absolute; inset:0;
      background:linear-gradient(90deg,transparent,rgba(0,229,255,.04),transparent);
      transform:translateX(-100%); transition:transform .5s var(--ease);
    }
    .action-card:hover:not(:disabled)::before { transform:translateX(100%); }
    .action-card:hover:not(:disabled) {
      background:rgba(0,229,255,.04);
    }
    .action-card:disabled {
      opacity:.3; cursor:not-allowed;
    }
    .action-card:disabled::before { display:none; }
    .action-icon-wrap {
      width:42px; height:42px; flex-shrink:0;
      display:flex; align-items:center; justify-content:center;
      border:1px solid rgba(0,229,255,.3);
      background:rgba(0,229,255,.04);
      border-radius:var(--radius);
      transition:all .3s var(--ease);
    }
    .action-card:hover:not(:disabled) .action-icon-wrap {
      border-color:var(--cyan);
      background:rgba(0,229,255,.1);
      box-shadow:0 0 15px rgba(0,229,255,.15);
    }
    .action-icon-wrap.action-icon-pink {
      border-color:rgba(255,45,255,.3);
      background:rgba(255,45,255,.04);
    }
    .action-card:hover:not(:disabled) .action-icon-pink {
      border-color:var(--pink);
      background:rgba(255,45,255,.1);
      box-shadow:0 0 15px rgba(255,45,255,.15);
    }
    .action-icon {
      width:20px; height:20px; color:var(--cyan);
    }
    .action-icon-pink .action-icon {
      color:var(--pink);
    }
    .action-text {
      display:flex; flex-direction:column; gap:2px; flex:1; min-width:0;
    }
    .action-label {
      font-family:var(--f-hud); font-size:.68rem; letter-spacing:2px;
      color:var(--text); transition:color .3s;
    }
    .action-card:hover:not(:disabled) .action-label { color:#fff; }
    .action-desc {
      font-family:var(--f-body); font-size:.72rem; letter-spacing:.5px;
      color:var(--dim);
    }
    .action-feedback {
      font-family:var(--f-hud); font-size:.55rem; letter-spacing:2px;
      padding:3px 10px; border-radius:var(--radius);
      opacity:0; transform:translateY(4px);
      transition:all .3s var(--ease);
      white-space:nowrap; flex-shrink:0;
    }
    .action-feedback.show {
      opacity:1; transform:none;
    }
    .action-feedback.success {
      color:var(--green); border:1px solid rgba(0,255,106,.4);
      background:rgba(0,255,106,.06);
    }
    .action-feedback.error {
      color:var(--red); border:1px solid rgba(255,59,59,.4);
      background:rgba(255,59,59,.06);
    }

    @media(max-width:580px){
      .action-panel-body { flex-direction:column; }
      .action-divider { width:auto; height:1px; }
      .action-card { padding:14px 16px; }
    }

    /* ═══ CONSOLE ════════════════════════════════════════════════════════ */
    .cons { background:rgba(0,0,0,.8); border:1px solid var(--border); border-radius:var(--radius); animation:fadeSlide .6s .3s var(--ease) both; }
    .cons-h {
      display:flex; justify-content:space-between; align-items:center;
      padding:8px 14px; border-bottom:1px solid var(--border); background:rgba(0,255,106,.015);
    }
    .cons-title { font-family:var(--f-hud); font-size:.58rem; letter-spacing:2.5px; color:var(--green); }
    .cons-right { display:flex; align-items:center; gap:10px; }
    #cev { font-size:.55rem; color:var(--dim); font-family:var(--f-hud); letter-spacing:1px; }
    .cons-clr {
      padding:3px 10px; background:transparent; border:1px solid rgba(255,59,59,.25);
      color:rgba(255,59,59,.8); font-family:var(--f-mono); font-size:.55rem;
      cursor:pointer; transition:all .2s; border-radius:var(--radius); letter-spacing:1px;
    }
    .cons-clr:hover { border-color:var(--red); color:var(--red); background:rgba(255,59,59,.06); }
    .cons-b { height:130px; overflow-y:auto; padding:8px 14px; }
    .cl { font-size:.7rem; color:var(--green); padding:2px 0; border-bottom:1px solid rgba(0,255,106,.04); white-space:pre-wrap; word-break:break-all; }
    .cl.e { color:var(--red); }
    .cl.w { color:var(--amber); }
    .cl.i { color:var(--cyan); }

    /* ═══ FOOTER ═════════════════════════════════════════════════════════ */
    .footer {
      text-align:center;
      padding:16px 0 4px;
      font-family:var(--f-body);
      font-size:.68rem;
      color:var(--dim);
      letter-spacing:2px;
      animation:fadeSlide .6s .35s var(--ease) both;
    }
    .footer span { color:var(--cyan); }

    /* ═══ SCROLLBAR ══════════════════════════════════════════════════════ */
    ::-webkit-scrollbar { width:5px; height:5px; }
    ::-webkit-scrollbar-track { background:transparent; }
    ::-webkit-scrollbar-thumb { background:rgba(0,229,255,.18); border-radius:4px; }
    ::-webkit-scrollbar-thumb:hover { background:rgba(0,229,255,.3); }

    /* ═══ RESPONSIVE REFINEMENTS ═════════════════════════════════════════ */
    @media(max-width:480px){
      #app { padding:8px 8px 24px; }
      .shell { gap:10px; }
      .hdr { padding:14px 14px; }
      .brand-wrap { gap:8px; }
      .search { padding:14px; }
      #qbtn { padding:12px 16px; letter-spacing:2px; }
      .pb { padding:10px 12px; }
      .action-card { padding:12px 14px; gap:10px; }
      .intro-container { gap:8px; padding:12px 12px; }
      .intro-hex { width:50px; height:50px; }
      .intro-features { gap:8px; }
      .intro-feat { padding:10px 8px; }
      .intro-enter { padding:10px 28px; font-size:.68rem; }
      .intro-countdown { width:56px; height:56px; }
    }

    @media(max-width:360px){
      .brand { font-size:1.3rem; letter-spacing:.1em; }
      .brand-v { font-size:.5rem; }
      .srow { flex-direction:column; }
      #qbtn { width:100%; }
    }

    @media(min-width:1200px){
      .shell { max-width:1180px; }
    }

    /* ═══ FOCUS VISIBLE ══════════════════════════════════════════════════ */
    *:focus-visible {
      outline:2px solid var(--cyan);
      outline-offset:2px;
    }
    button:focus-visible {
      outline:2px solid var(--cyan);
      outline-offset:2px;
    }
  </style>
</head>
<body>
  <div class="scanlines"></div>
  <div class="vignette"></div>
  <canvas id="bg-canvas"></canvas>

  <!-- ═══ BOOT SCREEN ════════════════════════════════════════════════════ -->
  <div id="boot">
    <div id="term">
      <div id="boot-lines"></div>
      <span id="cur"></span>
      <div class="bbar"><div id="bprog"></div></div>
    </div>
  </div>

  <!-- ═══ INTRO / ABOUT ══════════════════════════════════════════════════ -->
  <div id="intro">
    <div class="intro-container">

      <!-- Animated Hexagonal Icon -->
      <div class="intro-hex">
        <svg viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
          <polygon points="60,5 110,30 110,90 60,115 10,90 10,30" stroke="rgba(0,229,255,.35)" stroke-width="1" fill="none"/>
          <polygon points="60,15 100,35 100,85 60,105 20,85 20,35" stroke="rgba(0,229,255,.2)" stroke-width="0.5" fill="rgba(0,229,255,.02)"/>
          <circle cx="60" cy="60" r="18" stroke="var(--cyan)" stroke-width="1.5" fill="rgba(0,229,255,.05)"/>
          <circle cx="60" cy="60" r="4" fill="var(--cyan)" opacity=".8"/>
          <line x1="60" y1="42" x2="60" y2="15" stroke="rgba(0,229,255,.25)" stroke-width=".5"/>
          <line x1="75" y1="52" x2="100" y2="35" stroke="rgba(0,229,255,.25)" stroke-width=".5"/>
          <line x1="75" y1="68" x2="100" y2="85" stroke="rgba(0,229,255,.25)" stroke-width=".5"/>
          <line x1="60" y1="78" x2="60" y2="105" stroke="rgba(0,229,255,.25)" stroke-width=".5"/>
          <line x1="45" y1="68" x2="20" y2="85" stroke="rgba(0,229,255,.25)" stroke-width=".5"/>
          <line x1="45" y1="52" x2="20" y2="35" stroke="rgba(0,229,255,.25)" stroke-width=".5"/>
          <circle cx="60" cy="15" r="2.5" fill="var(--pink)" opacity=".7"/>
          <circle cx="100" cy="35" r="2.5" fill="var(--green)" opacity=".7"/>
          <circle cx="100" cy="85" r="2.5" fill="var(--cyan)" opacity=".7"/>
          <circle cx="60" cy="105" r="2.5" fill="var(--amber)" opacity=".7"/>
          <circle cx="20" cy="85" r="2.5" fill="var(--pink)" opacity=".7"/>
          <circle cx="20" cy="35" r="2.5" fill="var(--green)" opacity=".7"/>
        </svg>
      </div>

      <div class="intro-title">NEXUS-TOOL</div>
      <div class="intro-version">VERSION 2.0 &nbsp;·&nbsp; NETWORK INTELLIGENCE</div>

      <p class="intro-desc">
        A real-time network intelligence and OSINT reconnaissance suite.
        Scan any IP address, domain, or URL to reveal geolocation data, open ports,
        DNS records, HTTP fingerprints, and security posture — all from a single interface.
      </p>

      <div class="intro-features">
        <div class="intro-feat">
          <div class="intro-feat-icon">◉</div>
          <div class="intro-feat-title">IP ANALYSIS</div>
          <div class="intro-feat-desc">Resolve & reverse-lookup any target</div>
        </div>
        <div class="intro-feat">
          <div class="intro-feat-icon">⊕</div>
          <div class="intro-feat-title">GEO INTEL</div>
          <div class="intro-feat-desc">Pinpoint location, ISP & ASN data</div>
        </div>
        <div class="intro-feat">
          <div class="intro-feat-icon">▣</div>
          <div class="intro-feat-title">PORT SCAN</div>
          <div class="intro-feat-desc">Detect open services across 16 ports</div>
        </div>
        <div class="intro-feat">
          <div class="intro-feat-icon">◈</div>
          <div class="intro-feat-title">DNS & HTTP</div>
          <div class="intro-feat-desc">MX, NS, TXT records & HTTP headers</div>
        </div>
      </div>

      <!-- Countdown Ring -->
      <div class="intro-countdown" id="introCountdown">
        <svg class="countdown-ring" viewBox="0 0 100 100">
          <circle class="countdown-track" cx="50" cy="50" r="44" />
          <circle class="countdown-fill" id="countdownFill" cx="50" cy="50" r="44" />
        </svg>
        <div class="countdown-num" id="countdownNum">10</div>
      </div>
      <div class="intro-auto">LAUNCHING IN <span id="countdownText">10</span>s &nbsp;·&nbsp; Press <kbd>Enter</kbd> to skip</div>
      <button class="intro-enter" id="introBtn">SKIP &nbsp;▸&nbsp; ENTER NOW</button>
    </div>
  </div>

  <!-- ═══ MAIN APP ═══════════════════════════════════════════════════════ -->
  <div id="app">
    <div class="shell">

      <!-- HEADER -->
      <header class="hdr">
        <div>
          <div class="brand-wrap">
            <div class="brand">NEXUS-TOOL</div>
            <div class="brand-v">V2</div>
          </div>
          <div class="brand-sub">// NETWORK INTELLIGENCE &nbsp;·&nbsp; OSINT SUITE</div>
        </div>
        <div class="hdr-right">
          <div class="h-clock" id="clock">00:00:00</div>
          <div class="h-tag"><span class="dot"></span><span style="color:var(--green);letter-spacing:2px;font-family:var(--f-hud);font-size:.55rem">SYSTEM ACTIVE</span></div>
          <div class="h-tag" id="cip" style="font-size:.55rem">CLIENT ▸ DETECTING...</div>
        </div>
      </header>

      <!-- SEARCH -->
      <section class="search">
        <p class="slabel">▸ TARGET INPUT</p>
        <div class="srow">
          <div class="iwrap">
            <span class="ipfx">▶</span>
            <input id="qi" type="text" placeholder="IP · domain · URL  (e.g. 8.8.8.8  or  github.com)" autocomplete="off" spellcheck="false" aria-label="Target input" />
          </div>
          <button id="qbtn" aria-label="Execute scan">EXECUTE</button>
        </div>
        <div class="sbar" id="sbar"><div class="sfill"></div></div>
        <p class="shint">Press <kbd>Enter</kbd> or click EXECUTE to begin scan</p>
      </section>

      <!-- HISTORY -->
      <div class="hbar" id="hbar">
        <span class="hlbl">RECENT ▸</span>
        <span style="color:var(--dim);font-size:.7rem">No history yet.</span>
      </div>

      <!-- RESULTS GRID -->
      <div class="grid" id="rgrid">
        <div class="panel a-core">
          <div class="ph"><span class="pt">◉ &nbsp;CORE_METRICS</span><span class="pbadge" id="typebadge"></span></div>
          <div class="pb" id="rCore"><div class="idle"><span class="idle-icon">[ — ]</span><span class="idle-txt">AWAITING SCAN</span></div></div>
        </div>
        <div class="panel a-geo">
          <div class="ph"><span class="pt">⊕ &nbsp;GEO_LOCATION</span></div>
          <div class="pb" id="rGeo"><div class="idle"><span class="idle-icon">[ — ]</span><span class="idle-txt">AWAITING SCAN</span></div></div>
        </div>
        <div class="panel a-ports">
          <div class="ph"><span class="pt">▣ &nbsp;PORT_SCAN</span><span class="pmeta" id="portmeta"></span></div>
          <div class="pb" id="rPorts"><div class="idle"><span class="idle-icon">[ — ]</span><span class="idle-txt">AWAITING SCAN</span></div></div>
        </div>
        <div class="panel a-dns">
          <div class="ph"><span class="pt">◈ &nbsp;DNS_RECORDS</span></div>
          <div class="pb" id="rDns"><div class="idle"><span class="idle-icon">[ — ]</span><span class="idle-txt">AWAITING SCAN</span></div></div>
        </div>
        <div class="panel a-http">
          <div class="ph"><span class="pt">⊞ &nbsp;HTTP_INTEL</span></div>
          <div class="pb" id="rHttp"><div class="idle"><span class="idle-icon">[ — ]</span><span class="idle-txt">AWAITING SCAN</span></div></div>
        </div>
      </div>

      <!-- ACTION BAR -->
      <div class="action-panel" id="actionPanel">
        <div class="action-panel-header">
          <span class="action-panel-title">⬡ &nbsp;EXPORT_ACTIONS</span>
          <span class="action-panel-status" id="actionStatus">READY</span>
        </div>
        <div class="action-panel-body">
          <button class="action-card" id="btnCopy" disabled>
            <div class="action-icon-wrap">
              <svg class="action-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2"/>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
              </svg>
            </div>
            <div class="action-text">
              <span class="action-label">COPY JSON</span>
              <span class="action-desc">Copy scan results to clipboard</span>
            </div>
            <span class="action-feedback" id="copyFeedback"></span>
          </button>
          <div class="action-divider"></div>
          <button class="action-card" id="btnExport" disabled>
            <div class="action-icon-wrap action-icon-pink">
              <svg class="action-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
            </div>
            <div class="action-text">
              <span class="action-label">DOWNLOAD .JSON</span>
              <span class="action-desc">Save full report as a file</span>
            </div>
            <span class="action-feedback" id="exportFeedback"></span>
          </button>
        </div>
      </div>

      <!-- CONSOLE -->
      <div class="cons">
        <div class="cons-h">
          <span class="cons-title">SYSTEM_CONSOLE</span>
          <div class="cons-right">
            <span id="cev">0 events</span>
            <button class="cons-clr" id="btnConsClear" title="Clear console">CLEAR</button>
          </div>
        </div>
        <div class="cons-b" id="cb">
          <div class="cl i">[SYSTEM] Nexus-Tool v2.0 loaded. All modules active.</div>
        </div>
      </div>

      <!-- FOOTER -->
      <div class="footer">
        <span>NEXUS-TOOL</span> &nbsp;·&nbsp; V2.0 &nbsp;·&nbsp; NETWORK INTELLIGENCE SUITE
      </div>

    </div>
  </div>

  <script>
    /* ═══════════════════════════════════════════════════════════════════════
       NEXUS-TOOL V2 — JAVASCRIPT ENGINE
       ═══════════════════════════════════════════════════════════════════════ */

    // ── BOOT SEQUENCE ─────────────────────────────────────────────────────
    const SEQ = [
      {t:100,  txt:'NEXUS-TOOL',                                    c:'bt'},
      {t:320,  txt:'// NETWORK INTELLIGENCE SYSTEM V2.0',           c:'bs'},
      {t:550,  txt:'',                                               c:''},
      {t:700,  txt:'> INITIALIZING CORE MODULES...',                c:'bd'},
      {t:920,  txt:'[OK] Network socket layer ready',               c:'bok'},
      {t:1080, txt:'[OK] DNS resolver chains verified',             c:'bok'},
      {t:1240, txt:'[OK] Port scanner: 16 targets armed',           c:'bok'},
      {t:1400, txt:'[  ] Connecting to geo-intelligence...',        c:'bw'},
      {t:1650, txt:'[OK] GEO API endpoint confirmed',               c:'bok'},
      {t:1800, txt:'[OK] HTTP fingerprint engine active',           c:'bok'},
      {t:1950, txt:'[OK] Rate limiter active (15 req/min)',         c:'bok'},
      {t:2100, txt:'[OK] Security headers scanner online',          c:'bok'},
      {t:2250, txt:'',                                               c:''},
      {t:2400, txt:'> ALL SYSTEMS NOMINAL',                         c:'br'},
      {t:2560, txt:'> LAUNCHING NEXUS-TOOL V2...',                  c:'ba'},
    ];
    const OK_COUNT = SEQ.filter(s => s.c === 'bok').length;
    let okSeen = 0;

    (function boot() {
      const el  = document.getElementById('boot-lines');
      const bar = document.getElementById('bprog');
      SEQ.forEach(({t, txt, c}) => {
        setTimeout(() => {
          if (!txt && !c) { el.appendChild(document.createElement('br')); return; }
          const d = document.createElement('div');
          d.className = `bl ${c}`;
          d.textContent = txt;
          el.appendChild(d);
          if (c === 'bok') { okSeen++; bar.style.width = `${Math.round(okSeen/OK_COUNT*100)}%`; }
        }, t);
      });
      // After boot → show intro with countdown
      setTimeout(() => {
        document.getElementById('boot').classList.add('out');
      }, 3000);
      setTimeout(() => {
        document.getElementById('boot').style.display = 'none';
        showIntro();
      }, 3700);
    })();

    // ── INTRO SCREEN WITH 10-SECOND COUNTDOWN ────────────────────────────
    let countdownInterval = null;
    let introEntered = false;

    function showIntro() {
      const intro = document.getElementById('intro');
      intro.style.display = 'flex';
      requestAnimationFrame(() => requestAnimationFrame(() => {
        intro.classList.add('visible');
        startCountdown();
      }));
    }

    function startCountdown() {
      const TOTAL = 10;
      const CIRCUMFERENCE = 276.46; // 2 * PI * 44
      let remaining = TOTAL;
      const fill = document.getElementById('countdownFill');
      const numEl = document.getElementById('countdownNum');
      const textEl = document.getElementById('countdownText');

      // Initial state
      fill.style.strokeDashoffset = '0';

      countdownInterval = setInterval(() => {
        remaining--;
        if (remaining < 0) remaining = 0;
        numEl.textContent = remaining;
        textEl.textContent = remaining;

        // Animate the ring: offset goes from 0 → CIRCUMFERENCE
        const offset = CIRCUMFERENCE * ((TOTAL - remaining) / TOTAL);
        fill.style.strokeDashoffset = offset.toFixed(2);

        if (remaining <= 3) {
          numEl.style.color = 'var(--pink)';
          fill.style.stroke = 'var(--pink)';
          fill.style.filter = 'drop-shadow(0 0 8px rgba(255,45,255,.5))';
        }

        if (remaining <= 0) {
          clearInterval(countdownInterval);
          if (!introEntered) enterApp();
        }
      }, 1000);
    }

    function enterApp() {
      if (introEntered) return;
      introEntered = true;
      if (countdownInterval) clearInterval(countdownInterval);

      const intro = document.getElementById('intro');
      intro.classList.add('out');
      setTimeout(() => {
        intro.style.display = 'none';
        const app = document.getElementById('app');
        app.style.display = 'flex';
        requestAnimationFrame(() => requestAnimationFrame(() => app.classList.add('on')));
      }, 650);
    }

    document.getElementById('introBtn').addEventListener('click', enterApp);
    document.addEventListener('keydown', function introKey(e) {
      const intro = document.getElementById('intro');
      if (intro.classList.contains('visible') && !intro.classList.contains('out')) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          enterApp();
        }
      }
    });

    // ── BACKGROUND CANVAS ─────────────────────────────────────────────────
    (function canvas() {
      const cv = document.getElementById('bg-canvas');
      const cx = cv.getContext('2d');
      let W, H, pts = [];
      const resize = () => { W = cv.width = innerWidth; H = cv.height = innerHeight; };
      window.addEventListener('resize', resize); resize();

      class P {
        constructor(){
          this.x = Math.random()*W;
          this.y = Math.random()*H;
          this.vx = (Math.random()-.5)*.35;
          this.vy = (Math.random()-.5)*.35;
          this.size = Math.random()*1.2 + 0.4;
        }
        step(){
          this.x += this.vx; this.y += this.vy;
          if(this.x<0||this.x>W) this.vx *= -1;
          if(this.y<0||this.y>H) this.vy *= -1;
        }
        draw(){
          cx.fillStyle = 'rgba(0,200,255,.45)';
          cx.beginPath(); cx.arc(this.x, this.y, this.size, 0, Math.PI*2); cx.fill();
        }
      }
      const count = Math.min(65, Math.floor(W*H/25000));
      for(let i=0; i<count; i++) pts.push(new P());

      (function loop(){
        cx.fillStyle = 'rgba(3,5,8,.14)';
        cx.fillRect(0,0,W,H);
        for(let i=0; i<pts.length; i++){
          pts[i].step(); pts[i].draw();
          for(let j=i+1; j<pts.length; j++){
            const dx = pts[i].x - pts[j].x, dy = pts[i].y - pts[j].y;
            const d = Math.sqrt(dx*dx + dy*dy);
            if(d < 130){
              cx.strokeStyle = `rgba(0,200,255,${.08*(1-d/130)})`;
              cx.lineWidth = .5;
              cx.beginPath(); cx.moveTo(pts[i].x, pts[i].y); cx.lineTo(pts[j].x, pts[j].y); cx.stroke();
            }
          }
        }
        requestAnimationFrame(loop);
      })();
    })();

    // ── CLOCK ─────────────────────────────────────────────────────────────
    function updateClock() {
      document.getElementById('clock').textContent = new Date().toLocaleTimeString();
    }
    updateClock();
    setInterval(updateClock, 1000);

    // ── LOG ───────────────────────────────────────────────────────────────
    let evCount = 0;
    function log(msg, t='') {
      evCount++;
      document.getElementById('cev').textContent = `${evCount} event${evCount!==1?'s':''}`;
      const b = document.getElementById('cb');
      const d = document.createElement('div');
      d.className = `cl${t?' '+t:''}`;
      d.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
      b.appendChild(d); b.scrollTop = b.scrollHeight;
    }

    // ── CLIENT IP ─────────────────────────────────────────────────────────
    fetch('/api/whoami').then(r=>r.json()).then(d=>{
      document.getElementById('cip').textContent = `CLIENT ▸ ${d.ip}`;
      log(`Connected from: ${d.ip}`, 'i');
    }).catch(()=>{ document.getElementById('cip').textContent='CLIENT ▸ UNKNOWN'; });

    // ── HISTORY ───────────────────────────────────────────────────────────
    const HK = 'nxt2h', HM = 8;
    const loadH  = () => { try{ return JSON.parse(localStorage.getItem(HK))||[]; }catch{ return []; } };
    const saveH  = e  => { let h=loadH().filter(x=>x.i!==e.i); h.unshift(e); localStorage.setItem(HK,JSON.stringify(h.slice(0,HM))); };
    function renderH() {
      const bar = document.getElementById('hbar'), h = loadH();
      bar.innerHTML = '<span class="hlbl">RECENT ▸</span>';
      if(!h.length){ bar.innerHTML+='<span style="color:var(--dim);font-size:.7rem">No history yet.</span>'; return; }
      h.forEach(e=>{
        const c=document.createElement('button'); c.className='hchip'; c.title=`${e.ip||''}${e.cc?' · '+e.cc:''}`; c.textContent=e.i;
        c.addEventListener('click',()=>{ document.getElementById('qi').value=e.i; run(); }); bar.appendChild(c);
      });
      const x=document.createElement('button'); x.className='hclr'; x.textContent='CLEAR';
      x.addEventListener('click',()=>{ localStorage.removeItem(HK); renderH(); log('History cleared.'); }); bar.appendChild(x);
    }
    renderH();

    // ── ADD ROW HELPER ────────────────────────────────────────────────────
    function row(id, lbl, val, delay=0, cls='') {
      const d=document.createElement('div'); d.className='dr';
      d.innerHTML=`<span class="dl">${lbl}</span><span class="dv ${cls}">${val}</span>`;
      document.getElementById(id).appendChild(d);
      setTimeout(()=>d.classList.add('on'), delay);
      return d;
    }
    function scls(code){ return code<300?'g':code<400?'a':'r'; }

    // ── RENDER RESULTS ────────────────────────────────────────────────────
    let last = null;
    function render(data) {
      let d=0; const S=70;

      // badge
      const b=document.getElementById('typebadge');
      b.textContent=data.inputType.toUpperCase(); b.style.display='inline-block';

      // CORE
      row('rCore','TYPE',      data.inputType.toUpperCase(),                                       d+=S);
      row('rCore','HOSTNAME',  data.hostname||'—',                                                 d+=S);
      row('rCore','IP',        data.ipAddresses?data.ipAddresses.join(', '):(data.ip||'—'),        d+=S);
      (data.reverseHostnames||[]).forEach(h=>row('rCore','REVERSE DNS',h, d+=S-15));
      if(data.protocol) row('rCore','PROTOCOL', data.protocol.replace(':','').toUpperCase(),       d+=S);
      row('rCore','SCANNED',   new Date(data.timestamp).toLocaleString(),                          d+=S,'a');

      // GEO
      if(data.geo){
        const g=data.geo;
        row('rGeo','COUNTRY',  `${g.country} (${g.countryCode})`,  d+=S);
        row('rGeo','CITY',     g.city||'—',                         d+=S);
        row('rGeo','ISP',      g.isp||'—',                          d+=S);
        if(g.org)      row('rGeo','ORG',      g.org,      d+=S);
        if(g.as)       row('rGeo','ASN',      g.as,       d+=S);
        if(g.timezone) row('rGeo','TIMEZONE', g.timezone, d+=S);
        if(g.lat!=null&&g.lon!=null){
          const coord=`${g.lat.toFixed(4)}, ${g.lon.toFixed(4)}`;
          const r=row('rGeo','COORDINATES',`<span class="map">${coord}</span>`,d+=S);
          r.querySelector('.map').addEventListener('click',()=>window.open(`https://www.google.com/maps?q=${g.lat},${g.lon}`,'_blank'));
        }
      } else {
        row('rGeo','LOCATION','Private / Local IP', d+=S,'a');
      }

      // PORTS
      const opens = data.openPorts||[];
      const total = data.portsScanned ? data.portsScanned.length : 16;
      const meta  = document.getElementById('portmeta');
      meta.textContent = `${opens.length} OPEN · ${total} SCANNED`;
      meta.className   = `pmeta${opens.length?' open':''}`;

      if(opens.length){
        const w=document.createElement('div'); w.className='dr';
        w.innerHTML=`<span class="dl" style="padding-top:3px">OPEN PORTS</span><div class="pgrid">${
          opens.map(p=>`<div class="pbadge-port"><span class="pnum">${p.port}</span><span class="psvc">${p.service}</span></div>`).join('')
        }</div>`;
        document.getElementById('rPorts').appendChild(w);
        setTimeout(()=>w.classList.add('on'), d+=S);
        opens.forEach(p=>log(`Open: ${p.port} (${p.service})`,'i'));
      } else {
        row('rPorts','STATUS','No open ports detected', d+=S,'a');
      }
      if(data.portsScanned){
        const on=opens.map(p=>p.port);
        const cl=data.portsScanned.filter(p=>!on.includes(p));
        if(cl.length){
          const cr=document.createElement('div'); cr.className='dr';
          cr.innerHTML=`<span class="dl">FILTERED</span><span class="dv d closed-list">${cl.join(' · ')}</span>`;
          document.getElementById('rPorts').appendChild(cr);
          setTimeout(()=>cr.classList.add('on'), d+=S);
        }
      }

      // DNS
      let dnsAny=false;
      if(data.dns){
        (data.dns.mx||[]).forEach(mx=>{ dnsAny=true; row('rDns','MX',`${mx.exchange} <span style="opacity:.75">(pri ${mx.priority})</span>`,d+=S); });
        (data.dns.ns||[]).forEach(ns=>{ dnsAny=true; row('rDns','NS',ns,d+=S-15); });
        (data.dns.txt||[]).forEach((rec,i)=>{
          dnsAny=true;
          const short=rec.length>66?rec.slice(0,63)+'…':rec;
          row('rDns',`TXT[${i}]`,`<span class="txt-r" title="${rec.replace(/"/g,'&quot;')}">${short}</span>`,d+=S-20);
          log(`TXT[${i}]: ${rec.slice(0,55)}${rec.length>55?'…':''}`);
        });
      }
      if(!dnsAny) row('rDns','STATUS','No DNS records found', d+=S,'a');

      // HTTP
      if(data.http&&!data.http.error){
        const h=data.http;
        if(h.status)      row('rHttp','STATUS',      `${h.status} ${h.statusText||''}`, d+=S, scls(h.status));
        if(h.server)      row('rHttp','SERVER',      h.server,                           d+=S,'g');
        if(h.poweredBy)   row('rHttp','POWERED BY',  h.poweredBy,                        d+=S,'g');
        if(h.contentType) row('rHttp','CONTENT TYPE',h.contentType.split(';')[0],        d+=S);
        const sr=document.createElement('div'); sr.className='dr';
        sr.innerHTML=`<span class="dl">SECURITY</span><div class="secs">
          ${h.hsts?'<span class="sbadge sok">HSTS ✓</span>':'<span class="sbadge snok">HSTS ✗</span>'}
          ${h.xFrameOptions?`<span class="sbadge sok">X-FRAME: ${h.xFrameOptions}</span>`:'<span class="sbadge snok">X-FRAME MISSING</span>'}
        </div>`;
        document.getElementById('rHttp').appendChild(sr);
        setTimeout(()=>sr.classList.add('on'), d+=S);
      } else if(data.http&&data.http.error){
        row('rHttp','STATUS','Host unreachable via HTTP', d+=S,'a');
      } else {
        row('rHttp','NOTE','HTTP scan skipped for raw IP input', d+=S,'d');
      }
    }

    // ── EXECUTE SCAN ──────────────────────────────────────────────────────
    async function run() {
      const input=document.getElementById('qi').value.trim();
      if(!input) return;
      const btn=document.getElementById('qbtn'), bar=document.getElementById('sbar'), grid=document.getElementById('rgrid');
      btn.disabled=true; btn.textContent='SCANNING...'; bar.classList.add('on'); grid.classList.add('scanning');
      ['rCore','rGeo','rPorts','rDns','rHttp'].forEach(id=>document.getElementById(id).innerHTML='');
      document.getElementById('typebadge').style.display='none';
      document.getElementById('portmeta').textContent='';
      document.getElementById('btnCopy').disabled=true; document.getElementById('btnExport').disabled=true;
      log(`Trace: ${input}`,'i');
      try {
        const res=await fetch('/api/lookup',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({value:input})});
        if(res.status===429) throw new Error('Rate limit reached. Wait 1 minute.');
        const data=await res.json();
        if(data.error) throw new Error(data.error);
        log(`Done — ${(data.openPorts||[]).length} port(s) open · ${(data.dns.txt||[]).length} TXT record(s)`);
        last=data;
        document.getElementById('btnCopy').disabled=false; document.getElementById('btnExport').disabled=false;
        updateActionStatus();
        render(data);
        saveH({i:input, ip:data.ip, hostname:data.hostname, cc:data.geo?.countryCode});
        renderH();
      } catch(e) {
        log(`ERROR: ${e.message}`,'e');
        document.getElementById('rCore').innerHTML=`<div class="idle" style="color:var(--red)"><span class="idle-icon">[ ✕ ]</span><span class="idle-txt">${e.message}</span></div>`;
      } finally {
        btn.disabled=false; btn.textContent='EXECUTE'; bar.classList.remove('on'); grid.classList.remove('scanning');
      }
    }

    // ── COPY / EXPORT ─────────────────────────────────────────────────────
    function showFeedback(id, text, type='success') {
      const el = document.getElementById(id);
      el.textContent = text;
      el.className = `action-feedback show ${type}`;
      setTimeout(() => { el.className = 'action-feedback'; }, 2200);
    }
    function updateActionStatus() {
      const s = document.getElementById('actionStatus');
      if (last) { s.textContent = 'DATA READY'; s.className = 'action-panel-status active'; }
      else { s.textContent = 'READY'; s.className = 'action-panel-status'; }
    }

    document.getElementById('btnCopy').addEventListener('click', async ()=>{
      if(!last) return;
      const j=JSON.stringify(last,null,2);
      try{
        await navigator.clipboard.writeText(j);
        log('JSON copied to clipboard.');
        showFeedback('copyFeedback','✓ COPIED','success');
      } catch{
        const t=document.createElement('textarea'); t.value=j; t.style.cssText='position:fixed;opacity:0';
        document.body.appendChild(t); t.select(); document.execCommand('copy'); document.body.removeChild(t);
        log('JSON copied (fallback).');
        showFeedback('copyFeedback','✓ COPIED','success');
      }
    });
    document.getElementById('btnExport').addEventListener('click', ()=>{
      if(!last) return;
      try {
        const j=JSON.stringify(last,null,2), b=new Blob([j],{type:'application/json'}), u=URL.createObjectURL(b), a=document.createElement('a');
        const n=`nexus-tool-${(last.hostname||last.ip).replace(/[^a-z0-9.-]/gi,'_')}-${Date.now()}.json`;
        a.href=u; a.download=n; a.click(); URL.revokeObjectURL(u);
        log(`Exported: ${n}`);
        showFeedback('exportFeedback','✓ SAVED','success');
      } catch(e) {
        log(`Export error: ${e.message}`,'e');
        showFeedback('exportFeedback','✗ FAILED','error');
      }
    });

    // ── CONSOLE CLEAR ───────────────────────────────────────────────────
    document.getElementById('btnConsClear').addEventListener('click', () => {
      const cb = document.getElementById('cb');
      cb.innerHTML = '';
      evCount = 0;
      document.getElementById('cev').textContent = '0 events';
      const d = document.createElement('div');
      d.className = 'cl i';
      d.textContent = `[${new Date().toLocaleTimeString()}] Console cleared.`;
      cb.appendChild(d);
      evCount = 1;
      document.getElementById('cev').textContent = '1 event';
    });

    // ── EVENTS ────────────────────────────────────────────────────────────
    document.getElementById('qbtn').addEventListener('click', run);
    document.getElementById('qi').addEventListener('keydown', e=>{ if(e.key==='Enter') run(); });
  </script>
</body>
</html>